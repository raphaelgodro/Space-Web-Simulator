goog.provide("entropy.stars.Stars"),entropy.stars.Stars=function(){this.stars=new THREE.Group;var a=new THREE.SphereGeometry(25e3,80,80),b=THREE.ImageUtils.loadTexture("../../static/img/stars5_min.jpg");b.repeat.set(1,1);var c=new THREE.MeshBasicMaterial({map:b}),d=new THREE.Mesh(a,c);d.material.side=THREE.BackSide,this.stars.add(d)},entropy.stars.Stars.prototype.updatePosition=function(a){var b=a.getRenderingPosition();this.stars.position.set(b.x,b.y,b.z)},entropy.stars.Stars.prototype.getGroup=function(){return this.stars},goog.provide("entropy.corp.Corp"),entropy.corp.Corp=function(a){this.context=a,this.group=new THREE.Group,this.radius_=a.distance_friendly_crop?a.radius*a.distance_friendly_crop:a.radius,this.orbitCoordinate=goog.isDef(a.orbit_coordinates)?a.orbit_coordinates:[],this.stop=!0,this.atmosphereContext=a.atmosphere_context,this.ringContext_=a.ring_context,this.orbitIndex=goog.isDef(a.orbit_index)?a.orbitIndex:0,this.layerGap_=.03,goog.isDef(a.distance_friendly_crop)&&(this.atmosphereContext.size*=a.distance_friendly_crop,this.layerGap_*=a.distance_friendly_crop),this.rotation_=a.rotation,this.rotationPerFrame_,goog.isDef(a.rotation_period)&&(this.rotationPerFrame_=0),this.texturePath_=a.texture_path,this.textureLayers_=[],this.atmosphereLayer,this.ringLayer,this.acc=[],this.positionLayer=new THREE.Mesh,this.addTexture_(this.texturePath_),goog.isDef(this.ringContext_)&&this.loadRing_(),this.group.add(this.positionLayer),this.loadAtmosphere_(),this.ringLayer?this.shadowLayer_=this.textureLayers_[0]:(this.shadowLayer_=this.createLayer_("../../static/img/shadow.png"),this.group.add(this.shadowLayer_)),this.distancePerAU=600,this.satelliteExtrapolationFactor_=4;var b=this.context.initial_speed;this.speed=[b[0],b[1],b[2]];var c=this.context.initial_position;this.setPosition(c),this.position_=c,this.parentCorp,this.childCorpses=[],this.relatedStars},entropy.corp.Corp.prototype.createLayer_=function(a){var b=this.radius_+this.textureLayers_.length*this.layerGap_,c=new THREE.SphereGeometry(b,140,140),d=THREE.ImageUtils.loadTexture(a);d.repeat.set(1,1);var e=new THREE.MeshBasicMaterial({map:d,transparent:!0}),f=new THREE.Mesh(c,e);return f},entropy.corp.Corp.prototype.addTexture_=function(a){var b=this.createLayer_(a);this.textureLayers_.push(b),this.group.add(b)},entropy.corp.Corp.prototype.loadAtmosphere_=function(){var a=this.atmosphereContext,b=a.size,c=new THREE.PlaneGeometry(b,b,3),d=THREE.ImageUtils.loadTexture(a.texture_path),e=a.color,f=new THREE.MeshBasicMaterial({map:d,transparent:!0,color:"rgb("+e[0]+", "+e[1]+", "+e[2]+")"});this.atmosphereLayer=new THREE.Mesh(c,f),this.group.add(this.atmosphereLayer)},entropy.corp.Corp.prototype.loadRing_=function(){var a=this.ringContext_,b=a.ring_size,c=new THREE.PlaneGeometry(b,b,1),d=THREE.ImageUtils.loadTexture(a.ring_path),e=new THREE.MeshBasicMaterial({map:d,transparent:!0,side:THREE.DoubleSide});if(this.ringLayer=new THREE.Mesh(c,e),this.group.add(this.ringLayer),goog.isDef(a.ring_rotation)){var f=new THREE.Vector3(a.ring_rotation[0],a.ring_rotation[1],a.ring_rotation[2]);this.ringLayer.rotation.set(f.x,f.y,f.z)}},entropy.corp.Corp.prototype.updatePosition=function(a){if(a.async){var b=this.orbitIndex,c=this.orbitCoordinate[b],d=10;this.setPosition(c),this.speed=[c[3],c[4],c[5]],b+d<this.orbitCoordinate.length-1?this.orbitIndex+=d:this.orbitIndex=0}else a.updateCorpPosition(this)},entropy.corp.Corp.prototype.updateRotation=function(a,b,c){var d=this.textureLayers_;if(goog.isDef(this.rotation_)&&!this.ringLayer)for(i=0;i<d.length;++i){var e=d[i].rotation;e.set(e.x+this.rotation_[0],e.y+this.rotation_[1],e.z+this.rotation_[2])}c||this.atmosphereLayer.position.set(this.group.position.x-b.x,this.group.position.y-b.y,this.group.position.z-b.z),this.atmosphereLayer.lookAt(a),this.atmosphereLayer.position.set(0,0,0),this.relatedStars.forEach(function(a){var b=a.getRenderingPosition(),c=this.getRenderingPosition(),d=b.x-c.x,e=b.z-c.z,f=Math.atan(d/e),g=e>=0?1:3,h=this.shadowLayer_.rotation;h.set(h.x=0,h.y=g*Math.PI/2-.1+f,h.z=0)},this)},entropy.corp.Corp.prototype.getPosition=function(){return this.position_},entropy.corp.Corp.prototype.getRadiusBox=function(){return goog.isDef(this.ringContext_)?this.ringContext_.ring_size:this.radius_},entropy.corp.Corp.prototype.getRenderingPosition=function(){return this.group.position},entropy.corp.Corp.prototype.getSpeed=function(){return this.speed},entropy.corp.Corp.prototype.getCoordinate=function(){return[this.position_[0],this.position_[1],this.position_[2],this.speed[0],this.speed[1],this.speed[2]]},entropy.corp.Corp.prototype.setPosition=function(a){if(this.position_=a,goog.isDef(this.parentCorp))for(var b=this.parentCorp,c=b.getPosition(),d=[],e=0;e<a.length;e++)d.push(c[e]+(c[e]-a[e])*this.satelliteExtrapolationFactor_);else d=a;this.group.position.set(d[0]*this.distancePerAU,d[1]*this.distancePerAU,d[2]*this.distancePerAU)},entropy.corp.Corp.prototype.setSpeed=function(a){this.speed=a},entropy.corp.Corp.prototype.appendCoordinate=function(a){this.orbitCoordinate.push(a)},entropy.corp.Corp.prototype.break=function(){this.stop=!0},entropy.corp.Corp.prototype.start=function(){this.stop=!1},goog.provide("entropy.corp.Planet"),entropy.corp.Planet=function(a){goog.base(this,a)},goog.inherits(entropy.corp.Planet,entropy.corp.Corp),goog.provide("entropy.corp.Star"),entropy.corp.Star=function(a){},goog.inherits(entropy.corp.Star,entropy.corp.Corp),entropy.corp.CorpType={PLANET:2,STAR:1,SATELITTE:3,COMET:4,ROGUE:5,BLACK_HOLE:6,SPACE_SHIP:7},entropy.corp.Factory=function(){},entropy.corp.Factory.prototype.createCorp=function(a){},goog.provide("entropy.solarsystem"),goog.require("entropy.corp.CorpType"),entropy.solarsystem.SolarSystem=function(a){this.context=a.solar_system,this.corps=[],this.stars=[];var b=this.context.corps;this.selectedCorp,goog.array.forEach(b,function(a){this.addCorp_(a)},this),goog.array.forEach(this.corps,function(a){if(a.context.parent_corp_id){var b=a.context.parent_corp_id,c=this.getCorpById(b);a.parentCorp=c,c.childCorpses.push(a)}},this),this.context.selected_corp_name&&(this.selectedCorp=this.getCorpByName(this.context.selected_corp_name)),this.corps.forEach(function(a){a.relatedStars=this.stars},this)},entropy.solarsystem.SolarSystem.prototype.addCorp_=function(a){corp=new entropy.corp.Corp(a),this.isStar_(corp)&&this.stars.push(corp),this.corps.push(corp)},entropy.solarsystem.SolarSystem.prototype.getCorpByName=function(a){var b;return goog.array.forEach(this.corps,function(c){c.context.name==a&&(b=c)},this),b},entropy.solarsystem.SolarSystem.prototype.getCorpById=function(a){var b;return goog.array.forEach(this.corps,function(c){c.context.id==a&&(b=c)},this),b},entropy.solarsystem.SolarSystem.prototype.isStar_=function(a){var b=a.context.corp_type_id;return entropy.corp.CorpType.STAR==b},goog.provide("entropy.physic.PhysicMachine"),entropy.physic.PhysicMachine=function(a,b){this.async=!1,this.corps_=a,this.renderer_=b,this.minDistanceMassRatio=.01,this.cycleIncertitude_=1e-8,this.deltaT_=1800,this.minTurnNumber_=20;var c=[];goog.array.forEach(this.corps_,function(a){0==a.orbitCoordinate.length&&c.push(a)},this),console.log("getting through ?"),this.async?(console.log("building cycles.."),this.buildCycles(c)):goog.array.forEach(this.corps_,function(a){a.start()},this)},entropy.physic.PhysicMachine.prototype.buildCycles=function(a){var c,b=this.corps_;c=goog.isDef(a)?a:this.corps_,goog.array.forEach(c,function(a){a.orbitCoordinate=[];for(var c=!1;!c;)this.calculatePhysic_(a,b),this.checkCycle_(a)&&a.orbitCoordinate.length>this.minTurnNumber_&&(c=!0,console.log("corp calculated",a));a.start()},this)},entropy.physic.PhysicMachine.prototype.updateCorpPosition=function(a){a.stop&&(a.stop=!1),this.async&&(this.async=!1),this.calculatePhysic_(a,this.corps_)},entropy.physic.PhysicMachine.prototype.calculatePhysic_=function(a,b){var c=a.context,d=this.getLastCoordinate_(a),e=0,f=0,g=0,h=1.496*Math.pow(10,11);goog.array.forEach(b,function(b){if(a!=b){var i=b.context,j=this.getLastCoordinate_(b),k=(j[0]-d[0])*h,l=(j[1]-d[1])*h,m=(j[2]-d[2])*h,n=Math.sqrt(Math.pow(k,2)+Math.pow(m,2)+Math.pow(l,2)),o=Math.acos(k/n),p=Math.acos(l/n),q=Math.acos(m/n),r=c.mass,s=i.mass,t=6.67*Math.pow(10,-11),u=t*r*s/Math.pow(n,2);e+=Math.cos(o)*u,f+=Math.cos(p)*u,g+=Math.cos(q)*u}},this),this.applyAxisForcesToCorp_(a,[e,f,g],d)},entropy.physic.PhysicMachine.prototype.applyAxisForcesToCorp_=function(a,b,c){var d=a.context.mass,e=1.496*Math.pow(10,11),f=[],g=[];for(index=0;index<b.length;++index){var h=b[index]/d,i=c[index]*e,j=i+c[index+3]*this.deltaT_+.5*h*Math.pow(this.deltaT_,2),k=c[index+3]+h*this.deltaT_,l=j/e;g.push(k),f.push(l)}this.async?a.appendCoordinate(f.concat(g)):(a.setPosition(f),a.setSpeed(g))},entropy.physic.PhysicMachine.prototype.checkCycle_=function(a){var b=a.orbitCoordinate[0],c=a.orbitCoordinate[a.orbitCoordinate.length-1],d=!0;for(index=0;index<3;++index)b[index]-c[index]>this.cycleIncertitude_&&(d=!1);return d},entropy.physic.PhysicMachine.prototype.normalizeCycle_=function(a){var b=6,c=a.orbitCoordinate,d=c[c.length-1-b/2],e=c[b/2];for(steps=[],f=0;f<3;++f)steps[f]=(d[f]-e[f])/b;for(i=0;i<b;++i){var f;for(f=i<b/2?c.length-1-b/2+i:i-b/2,j=0;j<3;++j)c[f][j]=d[j]+steps[j]*i}},entropy.physic.PhysicMachine.prototype.getLastCoordinate_=function(a){var b;return 0==a.orbitCoordinate.length?this.async?(b=a.context.initial_position,b=b.concat(a.context.initial_speed)):b=a.getCoordinate():b=a.orbitCoordinate[a.orbitCoordinate.length-1],b},entropy.physic.PhysicMachine.prototype.setDeltaT=function(a){this.deltaT_=a},entropy.physic.PhysicMachine.prototype.getDeltaT=function(){return this.deltaT_},goog.provide("entropy.menu.MenuTop"),entropy.menu.MenuTop=function(a){this.createMenu_(a)},entropy.menu.MenuTop.prototype.createMenu_=function(a){var b=goog.dom.createDom("div",{id:"header-menu"}),c=goog.dom.createDom("span",{id:"title","data-toggle":"modal","data-target":"#about-entropie"});goog.dom.append(c,"Entropie"),goog.dom.append(b,c);var d=goog.dom.createDom("div",{id:"corpTitleBg"}),e=goog.dom.createDom("span",{id:"corpTitle"}),f=goog.dom.createDom("span",{id:"solarsystemTitle"}),g=goog.dom.createDom("span",{id:"collapse-icon",class:"glyphicon glyphicon-collapse-up","aria-hidden":"true"});goog.dom.append(f,a.solar_system.name),goog.dom.append(d,e),goog.dom.append(b,f),goog.dom.append(b,g),goog.dom.append(b,d);var h=goog.dom.getElementsByTagNameAndClass("body")[0];goog.dom.appendChild(h,b)},goog.provide("entropy.menu.MenuCorp"),entropy.menu.MenuCorp=function(a){this.el_=goog.dom.getElement("corp-menu"),this.corpContext_=null,this.physicMachine_=a,this.corpProperties=new entropy.menu.PropertiesMenu(this.physicMachine_)},entropy.menu.MenuCorp.prototype.updateCorp=function(a){this.corp_=a,goog.dom.removeChildren(this.el_);var b=this.createMenu_();goog.dom.append(this.el_,b),this.updateMenuTopTitle_(),this.corpProperties.updateProperties(a)},entropy.menu.MenuCorp.prototype.createMenu_=function(){var a=this.corp_.context,b=goog.dom.createDom("div");if(goog.isDef(a.media)){var c=new entropy.media.PlanetSlider(a.media);goog.dom.append(b,c.slide)}return goog.dom.append(b,this.corpProperties.getElement()),b},entropy.menu.MenuCorp.prototype.updateMenuTopTitle_=function(){var a=goog.dom.getElement("corpTitle");goog.dom.removeChildren(a);var b=goog.dom.getElement("corpTitleBg"),c=this.corp_.atmosphereContext.color,d="rgba("+c[0]+", "+c[1]+", "+c[2]+", 1);",e=entropy.utils.rgb2Hex(d);b.style.backgroundColor=e,goog.dom.append(a,this.corp_.context.name)},goog.provide("entropy.menu.MenuSolarSystem"),entropy.menu.MenuSolarSystem=function(a){this.el_=goog.dom.getElement("corp-menu"),this.renderer_=a,this.solarSystem_=a.solarSystem,console.log(goog.dom.getElement("planetmenu")),this.el_=goog.dom.getElement("planetmenu"),this.satelliteEl_=goog.dom.getElement("satellitemenu"),this.createMenu_(),this.satelliteMenuEl_={},this.solarSystem_.selectedCorp?this.dirty_=!0:this.dirty=!1,this.handleMenuClick_(this.renderer_,this.renderer_.selectedCorp)},entropy.menu.MenuSolarSystem.prototype.createMenu_=function(){goog.array.forEach(this.solarSystem_.corps,function(a){if(!a.parentCorp){var b=goog.dom.createDom("li"),c=goog.dom.createDom("a"),d=goog.dom.createDom("b"),e=goog.dom.createDom("span"),f=new entropy.media.Image(a.context.texture_path,20);goog.events.listen(c,goog.events.EventType.CLICK,goog.partial(this.handleMenuClick_.bind(this),this.renderer_,a)),goog.dom.append(e,f.getElement()),goog.dom.append(c,e),goog.dom.append(d,a.context.name),goog.dom.append(c,d),goog.dom.append(b,c),goog.dom.append(this.el_,b)}},this)},entropy.menu.MenuSolarSystem.prototype.updateSatelliteMenu_=function(a){var b=$(this.el_).height();$(this.satelliteEl_).css("top","6%").css("top","+="+b+"px").css("top","+=20px"),goog.array.forEach(a,function(a){var b=goog.dom.createDom("li"),c=goog.dom.createDom("a"),d=goog.dom.createDom("b"),e=goog.dom.createDom("span");goog.events.listen(c,goog.events.EventType.CLICK,goog.partial(this.handleMenuClick_.bind(this),this.renderer_,a)),goog.dom.append(c,e),goog.dom.append(d,a.context.name),goog.dom.append(c,d),goog.dom.append(b,c),goog.dom.append(this.satelliteEl_,b)},this)},entropy.menu.MenuSolarSystem.prototype.handleMenuClick_=function(a,b){this.satelliteEl_.innerHTML="",a.setCameraFocus(b);var c=window.location.href,d=c.lastIndexOf("/"),e=this.dirty_?c.substring(0,d):c;if(window.history.pushState("",b.context.name,e+"/"+b.context.name),b.childCorpses.length>0||b.parentCorp){$(this.satelliteEl_).css("display","inline");var f=b.childCorpses.length>0?b.childCorpses:b.parentCorp.childCorpses;this.updateSatelliteMenu_(f)}else $(this.satelliteEl_).css("display","none");this.dirty_=!0},goog.provide("entropy.interaction.Interaction"),entropy.interaction.Interaction=function(){},entropy.interaction.Interaction.prototype.run=goog.abstractMethod,goog.provide("entropy.interaction.ToggleViewInteraction"),goog.provide("entropy.interaction.ToggleViewKey"),goog.require("goog.style"),entropy.interaction.ToggleViewKey={DEFAULT:72},entropy.interaction.ToggleViewInteraction=function(){this.toggled_=!1,this.solarSystemMenuEl_=goog.dom.getElement("solarsystemmenu"),this.headerMenuEl_=goog.dom.getElement("header-menu"),this.menuCorpEl_=goog.dom.getElement("corp-menu")},goog.inherits(entropy.interaction.Interaction,entropy.interaction.ToggleViewInteraction),entropy.interaction.ToggleViewInteraction.prototype.run=function(a){this.toggled_?(this.updateButton_(!1),this.changeDisplayEl_(this.solarSystemMenuEl_,1),this.changeDisplayEl_(this.headerMenuEl_,1),this.changeDisplayEl_(this.menuCorpEl_,1),this.toggled_=!1):(this.updateButton_(!0),this.changeDisplayEl_(this.solarSystemMenuEl_,0),this.changeDisplayEl_(this.headerMenuEl_,0),this.changeDisplayEl_(this.menuCorpEl_,0),this.toggled_=!0)},entropy.interaction.ToggleViewInteraction.prototype.changeDisplayEl_=function(a,b){goog.style.setOpacity(a,b)},entropy.interaction.ToggleViewInteraction.prototype.updateButton_=function(a){var b=$("#collapse-icon");if(b.remove(),a)$("body").append(b),$(b).removeClass("glyphicon glyphicon-collapse-up"),$(b).addClass("glyphicon glyphicon-collapse-down");else{var c=$("#header-menu");c.append(b),$(b).removeClass("glyphicon glyphicon-collapse-down"),$(b).addClass("glyphicon glyphicon-collapse-up")}},goog.provide("entropy.interaction.CameraMoveInteraction"),entropy.interaction.CameraMoveKey={LEFT:37,UP:38,RIGHT:39,DOWN:40},entropy.interaction.CameraMoveInteraction=function(a){this.renderer_=a},goog.inherits(entropy.interaction.Interaction,entropy.interaction.CameraMoveInteraction),entropy.interaction.CameraMoveInteraction.prototype.run=function(a){var b=this.renderer_,c=b.controls.getPolarAngle();console.log("polar",c);var d=b.controls.getAzimuthalAngle();console.log("azimuthal",d);var e=2;switch(console.log(this.renderer_),a){case entropy.interaction.CameraMoveKey.LEFT:b.moveCamera(new THREE.Vector3((-e),0,0));break;case entropy.interaction.CameraMoveKey.UP:b.moveCamera(new THREE.Vector3(0,0,(-e)));break;case entropy.interaction.CameraMoveKey.RIGHT:b.moveCamera(new THREE.Vector3(e,0,0));break;case entropy.interaction.CameraMoveKey.DOWN:b.moveCamera(new THREE.Vector3(0,0,e))}},goog.provide("entropy.interaction.SlideCorpMenuInteraction"),goog.require("goog.style"),entropy.interaction.SlideCorpMenuInteraction=function(){this.toggled_=!1,this.isToggling_=!1,this.menuCorpEl_=goog.dom.getElement("corp-menu"),this.eventSlideEl_=goog.dom.getElement("event-slide")},goog.inherits(entropy.interaction.Interaction,entropy.interaction.SlideCorpMenuInteraction),entropy.interaction.SlideCorpMenuInteraction.prototype.run=function(){this.isToggling_||(this.isToggling_=!0,this.toggled_?(this.displayMenu_(),this.toggled_=!1):(this.hideMenu_(),this.toggled_=!0),this.isToggling_=!1)},entropy.interaction.SlideCorpMenuInteraction.prototype.displayMenu_=function(){function d(){setTimeout(function(){goog.style.setStyle(a,"margin-right",-c+"%");var e=Math.floor(c/4);goog.style.setStyle(b,"margin-right",-e+"%"),c--,c>-1&&d()},15)}var a=this.menuCorpEl_,b=this.eventSlideEl_,c=100;d()},entropy.interaction.SlideCorpMenuInteraction.prototype.hideMenu_=function(){function d(){setTimeout(function(){goog.style.setStyle(a,"margin-right",-c+"%");var e=Math.floor(c/4);goog.style.setStyle(b,"margin-right",-e+"%");var e=Math.floor(c/4);c++,c<101&&d()},15)}var a=this.menuCorpEl_,b=this.eventSlideEl_,c=0;d()},goog.provide("entropy.interaction.KeyListener"),entropy.interaction.KeyListener=function(a){this.renderer_=a,this.interactionsMap_=[],this.createListeners_(),goog.events.listen(window,goog.events.EventType.KEYUP,this.handleKeyUp_,!1,this)},entropy.interaction.KeyListener.prototype.handleKeyUp_=function(a){var b=a.keyCode;this.interactionsMap_.forEach(function(a){if(a.key==b){var c=a.interaction;c.run(b)}})},entropy.interaction.KeyListener.prototype.createListeners_=function(a){this.renderer_;this.addInteraction_(entropy.interaction.ToggleViewKey.DEFAULT,new entropy.interaction.ToggleViewInteraction)},entropy.interaction.KeyListener.prototype.addInteraction_=function(a,b){this.interactionsMap_.push({key:a,interaction:b})},goog.provide("entropy.interaction.DomListener"),goog.require("goog.events"),goog.require("goog.fx"),goog.require("goog.fx.DragEvent"),goog.require("goog.events.EventType"),entropy.interaction.DomListener=function(a){this.renderer_=a,this.interactionsMap_=[],this.createListeners_()},entropy.interaction.DomListener.prototype.createListeners_=function(){this.addInteraction_(goog.dom.getElement("event-slide"),goog.events.EventType.CLICK,new entropy.interaction.SlideCorpMenuInteraction),this.addInteraction_(goog.dom.getElement("collapse-icon"),goog.events.EventType.CLICK,new entropy.interaction.ToggleViewInteraction),this.interactionsMap_.forEach(function(a){var b=a.interaction;goog.events.listen(a.element,a.eventType,b.run,!1,b)},this)},entropy.interaction.DomListener.prototype.addInteraction_=function(a,b,c){this.interactionsMap_.push({element:a,eventType:b,interaction:c})},goog.require("entropy.corp.Corp"),goog.require("entropy.corp.Planet"),goog.require("entropy.physic.PhysicMachine"),goog.require("entropy.solarsystem.SolarSystem"),goog.require("entropy.interaction.CameraMoveInteraction"),goog.require("entropy.stars.Stars"),goog.require("goog.dom"),goog.provide("entropy.renderer"),entropy.renderer.Renderer=function(a){function d(){alert("resize !!!"),this.camera_.aspect=window.innerWidth/window.innerHeight,this.camera_.updateProjectionMatrix(),this.renderer_.setSize(window.innerWidth,window.innerHeight)}var b=goog.dom.getElement("renderer");this.width_=window.innerWidth,this.height_=window.innerHeight,this.scene_=new THREE.Scene,this.renderer_=new THREE.WebGLRenderer({alpha:!0}),this.camera_=new THREE.PerspectiveCamera(60,this.width_/this.height_,3,3e4),this.aimingCameraObject_=new THREE.Group,this.solarSystem=a,this.physicsMachine_=new entropy.physic.PhysicMachine(a.corps);context;this.corpMenu_=new entropy.menu.MenuCorp(this.physicsMachine_),this.backgroundTexture,this.selectedCorp=a.selectedCorp?a.selectedCorp:a.stars[0],this.renderer_.setClearColor(0,1),this.renderer_.setSize(this.width_,this.height_),controls=new THREE.OrbitControls(this.camera_,renderer.domElement),controls.enableDamping=!0,controls.dampingFactor=.25,controls.enableZoom=!0,this.controls=controls,this.stars=new entropy.stars.Stars,this.scene_.add(this.stars.stars),this.scene_.add(this.aimingCameraObject_),this.loadCorps(this.solarSystem.corps),this.setCameraFocus(this.selectedCorp),b.appendChild(this.renderer_.domElement),controls.update(),this.render(),window.addEventListener("resize",d,!1)},entropy.renderer.Renderer.prototype.render=function(){var a=this.renderer_,b=this.camera_,c=this.scene_,d=this.solarSystem,e=this.stars,f=goog.bind(function(){setTimeout(function(){requestAnimationFrame(f)},10),goog.array.forEach(d.corps,function(a){var c=goog.isDefAndNotNull(this.selectedCorp)?this.selectedCorp.getRenderingPosition():new THREE.Vector3(0,0,0);a.stop||a.updatePosition(this.physicsMachine_),a.updateRotation(b.position,c,a==this.selectedCorp),e.updatePosition(this.selectedCorp)},this),a.render(c,b)},this);f()},entropy.renderer.Renderer.prototype.loadCorps=function(a){for(index=0;index<a.length;++index)this.loadCorp(a[index])},entropy.renderer.Renderer.prototype.loadCorp=function(a){this.scene_.add(a.group)},entropy.renderer.Renderer.prototype.setCameraFocus=function(a){goog.isNull(a)?this.camera_.lookAt(new THREE.Vector3(0,0,0)):(this.selectedCorp=a,this.corpMenu_.updateCorp(a),this.selectedCorp.group.add(this.camera_),this.controls.constraint.minDistance=a.getRadiusBox()+5)},entropy.renderer.Renderer.prototype.moveCamera=function(a){var b=this.camera_,c=b.position.x,d=b.position.y,e=b.position.z;if(goog.isDefAndNotNull(this.selectedCorp)&&this.aimingCameraObject_.add(this.camera_),goog.isDefAndNotNull(this.selectedCorp)){var f=this.selectedCorp.getPosition();c=f.x,d=f.y,e=f.z,this.camera_.lookAt(f),this.selectedCorp=null}c+=a.x,d+=a.y,e+=a.z;var f=this.aimingCameraObject_.position;f.x=c,f.y=d,f.z=e,b.updateProjectionMatrix()},goog.provide("entropy.media.Image"),entropy.media.ImageWidthType={FULL:"full",PX:"pixel"},entropy.media.Image=function(a,b,c){this.el_=goog.dom.createDom("img",{src:a}),goog.isDef(b)&&(this.el_.style.width=b+"px"),goog.isDef(c)&&(this.el_.style.height=c+"px")},entropy.media.Image.prototype.getElement=function(){return this.el_},goog.require("goog.events"),goog.require("goog.events.Event"),goog.provide("entropy.media.PlanetSlider"),entropy.media.PlanetSlider=function(a){this.medias_=a,this.currentSlideId_=0,this.slide=this.createSlide_(a[this.currentSlideId_])},entropy.media.PlanetSlider.prototype.createSlide_=function(a){var b=goog.dom.createDom("div",{class:"planet-slider"}),c=new entropy.media.Image(a.image_path);goog.dom.append(b,c.getElement());var d=goog.dom.createDom("h3");goog.dom.append(d,a.title),goog.dom.append(b,d);var e=goog.dom.createElement("p");return goog.dom.append(e,a.text),goog.dom.append(b,e),this.createArrows_(b),b},entropy.media.PlanetSlider.prototype.createArrows_=function(a){var b=this.currentSlideId_,c=this.medias_.length,d=goog.dom.createDom("div",{class:"arrows"});if(0!=b){var e=goog.dom.createDom("span",{class:"glyphicon glyphicon-chevron-left"});goog.events.listen(e,"click",this.handleLeftArrow_,!1,this),goog.dom.append(d,e)}if(b!=c-1){var f=goog.dom.createDom("span",{class:"glyphicon glyphicon-chevron-right"});goog.dom.append(d,f),goog.events.listen(f,"click",this.handleRightArrow_,!1,this)}goog.dom.append(a,d)},entropy.media.PlanetSlider.prototype.handleLeftArrow_=function(a){this.currentSlideId_-=1,this.updateSlide_()},entropy.media.PlanetSlider.prototype.handleRightArrow_=function(a){this.currentSlideId_+=1,this.updateSlide_()},entropy.media.PlanetSlider.prototype.updateSlide_=function(){var b=(goog.dom.getElementsByTagNameAndClass("planet-slider")[0],goog.dom.getElement("corp-menu"));goog.dom.removeChildren(b,this.slide),this.slide=this.createSlide_(this.medias_[this.currentSlideId_]),goog.dom.append(b,this.slide)},goog.provide("entropy.menu.PropertiesMenu"),goog.require("goog.events"),goog.require("goog.events.Event"),entropy.menu.PropertiesMenu=function(a){this.corp_=null,this.physicMachine_=a,this.el_=this.createMenu_()},entropy.menu.PropertiesMenu.prototype.getElement=function(){return this.el_},entropy.menu.PropertiesMenu.prototype.updateProperties=function(a){$("#Mass").unbind("change",this.handleMassChange_),$("#Secondinsimulatorpersecond").unbind("change",this.handleDeltaTChange_),this.corp_=a;var b=14,c=numeral(a.context.mass.toPrecision(b)).format("0.000");$("#Mass").val(c);var d=60*this.physicMachine_.getDeltaT();$("#Secondinsimulatorpersecond").val(d),$("#Mass").change(this.handleMassChange_.bind(this)),$("#Secondinsimulatorpersecond").change(this.handleDeltaTChange_.bind(this))},entropy.menu.PropertiesMenu.prototype.createMenu_=function(){var a=goog.dom.createDom("div",{class:"corp-menu-properties"}),b=goog.dom.createDom("h3");goog.dom.append(b,"Space-Time Properties");var c=goog.dom.createDom("form"),d=this.createRow_([{label:"Second in simulator per second",type:"number",class:["col-sm-7","col-sm-5"]}]);goog.dom.append(a,b);var e=goog.dom.createDom("h3");goog.dom.append(e,"Corp Properties"),goog.dom.append(c,d),goog.dom.append(a,c),goog.dom.append(a,e),c=goog.dom.createDom("form");var d=this.createRow_([{label:"Mass",type:"number",class:["col-sm-2","col-sm-4"]},{label:"Speed",type:"number",class:["col-sm-2","col-sm-4"]}]);return goog.dom.append(c,d),goog.dom.append(a,c),a},entropy.menu.PropertiesMenu.prototype.createProperty_=function(a,b,c,d){var e=goog.dom.createDom("label",{for:"massInput",class:d[0]}),f=goog.dom.createDom("div",{class:d[1]}),g=goog.dom.createDom("input",{type:c,class:"form-control",id:b.replace(/\s/g,"")});$(g).click(function(){$(g).focus()}),goog.dom.append(a,e),goog.dom.append(e,b),goog.dom.append(f,g),goog.dom.append(a,f)},entropy.menu.PropertiesMenu.prototype.createRow_=function(a){for(var b=goog.dom.createDom("fieldSet",{class:"form-group-row"}),c=0;c<a.length;c++)this.createProperty_(b,a[c].label,a[c].type,a[c].class);return b},entropy.menu.PropertiesMenu.prototype.handleMassChange_=function(a){this.corp_.context.mass=parseFloat(a.currentTarget.value)},entropy.menu.PropertiesMenu.prototype.handleDeltaTChange_=function(a){console.log(this.physicMachine_),this.physicMachine_.setDeltaT(parseFloat(a.currentTarget.value)/60)},goog.require("entropy.solarsystem.SolarSystem"),goog.provide("entropy"),entropy.render=function(a){var c=(new entropy.menu.MenuTop(a),new entropy.solarsystem.SolarSystem(a)),d=new entropy.renderer.Renderer(c);new entropy.menu.MenuSolarSystem(d),new entropy.interaction.KeyListener(d),new entropy.interaction.DomListener(d)},goog.provide("utils"),entropy.utils=function(){},entropy.utils.rgb2Hex=function(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""};
